import{c as D,r as o,j as e,H as ae,g as h,t as r}from"./app-Bi53cwRe.js";import{M as re}from"./MainLayout-jKifpoFS.js";import{H as le}from"./Header-uQBK6Lvz.js";import{B as l}from"./use-theme-CGehCXYH.js";import{I as t}from"./input-P5n5ME8U.js";import{L as n}from"./label-COTh75sX.js";import{C as ie,a as oe,b as ne,d as ce,c as te}from"./card-CuJFQQ2i.js";import{D as f,f as de,a as N,b as C,c as w,e as me}from"./dialog-DHyflgsl.js";import{S as z,a as F,b as _,c as $,d as y}from"./select-CoSvZzaJ.js";import{T as he,a as ue,b as U,c as j,d as xe,e as u}from"./table-Cy4khzhc.js";import{B as k}from"./badge-De33JYzz.js";import{A as pe,f as je,T as ge,a as ve,b as be,c as fe,d as Ne,e as Ce,g as we,h as ye}from"./alert-dialog-BmfwfED2.js";import{U as ke}from"./user-plus-BMovOOA5.js";import{S as I}from"./shield-Cjmh3r0z.js";import{U as H}from"./user-DFNe86Sn.js";/* empty css            */import"./index-PFpZpo28.js";import"./index-DkYS_QLe.js";import"./index-DlbaUiBa.js";import"./check-Dyfwx27W.js";const De=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],Se=D("key",De);const Ee=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Pe=D("pencil",Ee);const Ue=[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]],Ae=D("power",Ue);const Oe=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Te=D("shield-check",Oe);function es({users:g}){const[q,A]=o.useState(!1),[L,S]=o.useState(!1),[M,E]=o.useState(!1),[R,P]=o.useState(!1),[d,m]=o.useState(null),[i,x]=o.useState({name:"",email:"",password:"",role:"vendedor"}),[c,v]=o.useState({name:"",email:"",role:"vendedor"}),[p,b]=o.useState({password:"",password_confirmation:""}),[O,T]=o.useState([]),V=[{value:"inicio",label:"Inicio"},{value:"vender",label:"Vender"},{value:"productos",label:"Productos"},{value:"clientes",label:"Clientes"},{value:"caja",label:"Caja"},{value:"reportes",label:"Reportes"},{value:"configuracion",label:"Configuración"}],B=s=>{s.preventDefault(),h.post("/configuracion/usuarios",i,{onSuccess:()=>{A(!1),x({name:"",email:"",password:"",role:"vendedor"}),r.success("Usuario creado correctamente")},onError:a=>r.error(Object.values(a)[0])})},G=s=>{s.preventDefault(),d&&h.put(`/configuracion/usuarios/${d.id}`,c,{onSuccess:()=>{S(!1),m(null),r.success("Usuario actualizado")},onError:a=>r.error(Object.values(a)[0])})},J=s=>{s.preventDefault(),d&&h.put(`/configuracion/usuarios/${d.id}/password`,p,{onSuccess:()=>{E(!1),m(null),b({password:"",password_confirmation:""}),r.success("Contraseña actualizada")},onError:a=>r.error(Object.values(a)[0])})},K=s=>{h.patch(`/configuracion/usuarios/${s.id}/toggle-active`,{},{onSuccess:()=>r.success(`Usuario ${s.active?"desactivado":"activado"}`),onError:a=>r.error(Object.values(a)[0])})},Q=s=>{h.delete(`/configuracion/usuarios/${s}`,{onSuccess:()=>r.success("Usuario eliminado"),onError:a=>r.error(Object.values(a)[0])})},W=s=>{m(s),v({name:s.name,email:s.email,role:s.role}),S(!0)},X=s=>{m(s),b({password:"",password_confirmation:""}),E(!0)},Y=s=>{m(s),T(s.permissions||[]),P(!0)},Z=s=>{s.preventDefault(),d&&h.put(`/configuracion/usuarios/${d.id}/permissions`,{permissions:O},{onSuccess:()=>{P(!1),m(null),r.success("Permisos actualizados")},onError:a=>r.error(Object.values(a)[0])})},ee=s=>{T(a=>a.includes(s)?a.filter(se=>se!==s):[...a,s])};return e.jsxs(re,{children:[e.jsx(ae,{title:"Empleados y Permisos"}),e.jsxs("div",{className:"flex-1 flex flex-col h-full bg-background",children:[e.jsx(le,{title:"Empleados y Permisos",subtitle:"Controla quién accede a tu sistema y qué puede hacer."}),e.jsx("main",{className:"flex-1 p-6 overflow-y-auto",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[e.jsxs(ie,{className:"border shadow-sm",children:[e.jsx(oe,{className:"border-b bg-card pb-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx(ne,{children:"Lista de Empleados"}),e.jsxs(ce,{children:[g.length," ",g.length!==1?"usuarios registrados":"usuario registrado"]})]}),e.jsxs(f,{open:q,onOpenChange:A,children:[e.jsx(de,{asChild:!0,children:e.jsxs(l,{className:"gap-3 bg-blue-600 hover:bg-blue-700 text-white shadow-sm transition-all duration-200 hover:scale-105",children:[e.jsx(ke,{className:"w-6 h-6"}),"Nuevo Usuario"]})}),e.jsxs(N,{children:[e.jsxs(C,{children:[e.jsx(w,{children:"Crear Nuevo Usuario"}),e.jsx(me,{children:"Agrega un nuevo empleado al sistema"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"create-name",children:"Nombre Completo"}),e.jsx(t,{id:"create-name",value:i.name,onChange:s=>x({...i,name:s.target.value}),placeholder:"Ej: Juan Pérez"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"create-email",children:"Correo Electrónico"}),e.jsx(t,{id:"create-email",type:"email",value:i.email,onChange:s=>x({...i,email:s.target.value}),placeholder:"correo@ejemplo.com"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"create-password",children:"Contraseña"}),e.jsx(t,{id:"create-password",type:"password",value:i.password,onChange:s=>x({...i,password:s.target.value}),placeholder:"Mínimo 8 caracteres"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"create-rol",children:"Rol del Usuario"}),e.jsxs(z,{value:i.role,onValueChange:s=>x({...i,role:s}),children:[e.jsx(F,{id:"create-rol",children:e.jsx(_,{placeholder:"Seleccionar rol"})}),e.jsxs($,{children:[e.jsx(y,{value:"admin",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"w-4 h-4"})," ","Administrador"]})}),e.jsx(y,{value:"vendedor",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(H,{className:"w-4 h-4"})," ","Cajero/Vendedor"]})})]})]})]}),e.jsx(l,{onClick:B,className:"w-full bg-blue-600 hover:bg-blue-700",children:"Crear Usuario"})]})]})]})]})}),e.jsx(te,{className:"p-0",children:e.jsxs(he,{children:[e.jsx(ue,{children:e.jsxs(U,{className:"bg-muted/50 hover:bg-muted/50",children:[e.jsx(j,{className:"pl-6",children:"Nombre"}),e.jsx(j,{children:"Correo"}),e.jsx(j,{children:"Rol"}),e.jsx(j,{children:"Estado"}),e.jsx(j,{className:"text-right pr-6",children:"Opciones"})]})}),e.jsx(xe,{children:g.length===0?e.jsx(U,{children:e.jsx(u,{colSpan:5,className:"text-center py-10 text-muted-foreground",children:"No hay usuarios registrados"})}):g.map(s=>e.jsxs(U,{className:"hover:bg-muted/50 transition-colors",children:[e.jsx(u,{className:"font-medium pl-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-9 w-9 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center text-blue-700 dark:text-blue-400 font-bold text-sm",children:s.name.charAt(0).toUpperCase()}),e.jsx("span",{className:"text-foreground",children:s.name})]})}),e.jsx(u,{className:"text-muted-foreground",children:s.email}),e.jsx(u,{children:s.role==="admin"?e.jsxs(k,{className:"bg-purple-500 hover:bg-purple-600 shadow-none",children:[e.jsx(Te,{className:"w-3 h-3 mr-1"})," ","Administrador"]}):e.jsxs(k,{variant:"secondary",className:"bg-muted text-foreground border-border hover:bg-accent shadow-none",children:[e.jsx(H,{className:"w-3 h-3 mr-1"})," ","Cajero"]})}),e.jsx(u,{children:s.active?e.jsx(k,{className:"bg-green-500 hover:bg-green-600 shadow-none",children:"Activo"}):e.jsx(k,{variant:"destructive",className:"shadow-none",children:"Inactivo"})}),e.jsx(u,{className:"text-right pr-6",children:e.jsxs("div",{className:"flex justify-end gap-1",children:[e.jsx(l,{variant:"outline",size:"sm",className:"h-8 w-8 p-0",onClick:()=>W(s),title:"Editar usuario",children:e.jsx(Pe,{className:"w-4 h-4 text-blue-600"})}),e.jsx(l,{variant:"outline",size:"sm",className:"h-8 w-8 p-0",onClick:()=>X(s),title:"Cambiar contraseña",children:e.jsx(Se,{className:"w-4 h-4 text-amber-600"})}),e.jsx(l,{variant:"outline",size:"sm",className:"h-8 w-8 p-0",onClick:()=>Y(s),title:"Gestionar permisos",children:e.jsx(I,{className:"w-4 h-4 text-purple-600"})}),e.jsx(l,{variant:"outline",size:"sm",className:"h-8 w-8 p-0",onClick:()=>K(s),title:s.active?"Desactivar":"Activar",children:e.jsx(Ae,{className:`w-4 h-4 ${s.active?"text-green-500":"text-gray-400"}`})}),e.jsxs(pe,{children:[e.jsx(je,{asChild:!0,children:e.jsx(l,{variant:"outline",size:"sm",className:"h-8 w-8 p-0",title:"Eliminar usuario",children:e.jsx(ge,{className:"w-4 h-4 text-destructive"})})}),e.jsxs(ve,{children:[e.jsxs(be,{children:[e.jsx(fe,{children:"¿Eliminar usuario?"}),e.jsxs(Ne,{children:["Estás a punto de eliminar a"," ",e.jsx("strong",{children:s.name}),". Esta acción es irreversible."]})]}),e.jsxs(Ce,{children:[e.jsx(we,{children:"Cancelar"}),e.jsx(ye,{onClick:()=>Q(s.id),className:"bg-red-600 hover:bg-red-700",children:"Eliminar"})]})]})]})]})})]},s.id))})]})})]}),e.jsx(f,{open:L,onOpenChange:S,children:e.jsxs(N,{children:[e.jsx(C,{children:e.jsx(w,{children:"Editar Usuario"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Nombre"}),e.jsx(t,{value:c.name,onChange:s=>v({...c,name:s.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Correo"}),e.jsx(t,{type:"email",value:c.email,onChange:s=>v({...c,email:s.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Rol"}),e.jsxs(z,{value:c.role,onValueChange:s=>v({...c,role:s}),children:[e.jsx(F,{children:e.jsx(_,{})}),e.jsxs($,{children:[e.jsx(y,{value:"admin",children:"Administrador"}),e.jsx(y,{value:"vendedor",children:"Cajero"})]})]})]}),e.jsx(l,{onClick:G,className:"w-full bg-blue-600",children:"Guardar Cambios"})]})]})}),e.jsx(f,{open:M,onOpenChange:E,children:e.jsxs(N,{children:[e.jsx(C,{children:e.jsx(w,{children:"Cambiar Contraseña"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Nueva Contraseña"}),e.jsx(t,{type:"password",value:p.password,onChange:s=>b({...p,password:s.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Confirmar"}),e.jsx(t,{type:"password",value:p.password_confirmation,onChange:s=>b({...p,password_confirmation:s.target.value}),required:!0})]}),e.jsx(l,{onClick:J,className:"w-full bg-orange-600 hover:bg-orange-700",children:"Actualizar"})]})]})}),e.jsx(f,{open:R,onOpenChange:P,children:e.jsxs(N,{className:"max-w-md",children:[e.jsx(C,{children:e.jsx(w,{children:"Permisos de Acceso"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-muted p-4 rounded-lg space-y-2 max-h-60 overflow-y-auto",children:V.map(s=>e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",id:`perm-${s.value}`,checked:O.includes(s.value),onChange:()=>ee(s.value),className:"rounded border-gray-300 text-blue-600 w-4 h-4"}),e.jsx("label",{htmlFor:`perm-${s.value}`,className:"text-sm font-medium cursor-pointer select-none",children:s.label})]},s.value))}),e.jsx(l,{onClick:Z,className:"w-full bg-blue-600",children:"Guardar Permisos"})]})]})})]})})]})]})}export{es as default};
