import{r as h,j as e,H as y,L as k}from"./app-Bi53cwRe.js";import{H as C}from"./Header-uQBK6Lvz.js";import{B as l}from"./use-theme-CGehCXYH.js";import{C as i,a as c,b as x,c as m}from"./card-CuJFQQ2i.js";import{T as _,a as v,b as u,c as r,d as D,e as t}from"./table-Cy4khzhc.js";import{B as R}from"./badge-De33JYzz.js";import{M as $,P as p,W as T}from"./MainLayout-jKifpoFS.js";import{D as E,a as F,b as P,c as H}from"./dialog-DHyflgsl.js";import{a as M,C as S,R as A}from"./ReporteCaja-C7PWxeyL.js";import{l as B}from"./index-3JJJLzBS.js";import{A as L}from"./arrow-left-DZzMb7wR.js";import{C as I}from"./credit-card-DwvTrN0f.js";/* empty css            */import"./user-DFNe86Sn.js";import"./index-PFpZpo28.js";function ae({cierre:s,movements:d}){const[f,n]=h.useState(!1),o=h.useRef(null),b=a=>new Date(a).toLocaleString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),j={fecha:b(s.created_at),usuario:s.user.name,sales_cash:s.sales_cash,sales_digital:s.sales_digital,manual_incomes:s.manual_incomes,manual_expenses:s.manual_expenses,expected_cash:s.expected_cash,counted_cash:s.counted_cash,difference:s.difference,notes:s.notes,movements:d},g=B.useReactToPrint({contentRef:o,documentTitle:`Reporte-Caja-${s.id}`,onAfterPrint:()=>console.log("Impresión finalizada"),onPrintError:a=>console.error("Error al imprimir:",a)}),N=()=>{n(!0)},w=()=>{if(!o.current){console.error("El contenido del reporte no está disponible");return}g()};return e.jsxs($,{children:[e.jsx(y,{title:`Cierre #${s.id}`}),e.jsxs("div",{className:"flex-1 flex flex-col h-full bg-background",children:[e.jsx(C,{title:`Detalle de Cierre #${s.id}`,subtitle:b(s.created_at)}),e.jsx("main",{className:"flex-1 p-6 overflow-y-auto",children:e.jsxs("div",{className:"max-w-5xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center print:hidden",children:[e.jsx(k,{href:"/caja",children:e.jsxs(l,{variant:"outline",className:"gap-2",children:[e.jsx(L,{className:"w-4 h-4"})," Volver a Caja"]})}),e.jsxs(l,{onClick:N,className:"gap-3 transition-all duration-200 hover:scale-105",children:[e.jsx(p,{className:"w-6 h-6"})," Imprimir Reporte"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(i,{children:[e.jsx(c,{className:"bg-muted/50 border-b pb-3",children:e.jsx(x,{className:"text-base font-bold text-foreground",children:"Resumen del Sistema"})}),e.jsxs(m,{className:"pt-4 space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center p-2 bg-emerald-50 dark:bg-emerald-950/20 rounded border border-emerald-100 dark:border-emerald-900",children:[e.jsxs("span",{className:"text-sm font-medium text-emerald-800 dark:text-emerald-300 flex items-center gap-2",children:[e.jsx(T,{className:"w-4 h-4"})," ","Ventas Efectivo"]}),e.jsxs("span",{className:"font-bold text-emerald-700 dark:text-emerald-400",children:["$"," ",Number(s.sales_cash).toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between items-center p-2 bg-blue-50 dark:bg-blue-950/20 rounded border border-blue-100 dark:border-blue-900",children:[e.jsxs("span",{className:"text-sm font-medium text-blue-800 dark:text-blue-300 flex items-center gap-2",children:[e.jsx(I,{className:"w-4 h-4"})," ","Ventas Digitales"]}),e.jsxs("span",{className:"font-bold text-blue-700 dark:text-blue-400",children:["$"," ",Number(s.sales_digital).toFixed(2)]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Ingresos Manuales"}),e.jsxs("p",{className:"text-green-600 font-bold flex items-center gap-1",children:[e.jsx(M,{className:"w-3 h-3"})," ","$"," ",Number(s.manual_incomes).toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Egresos Manuales"}),e.jsxs("p",{className:"text-red-600 font-bold flex items-center gap-1",children:[e.jsx(S,{className:"w-3 h-3"})," ","$"," ",Number(s.manual_expenses).toFixed(2)]})]})]}),e.jsxs("div",{className:"pt-2 border-t mt-2 flex justify-between items-center",children:[e.jsx("span",{className:"font-bold text-foreground",children:"Esperado en Cajón:"}),e.jsxs("span",{className:"text-xl font-bold text-foreground",children:["$"," ",Number(s.expected_cash).toFixed(2)]})]})]})]}),e.jsxs(i,{className:"border-2 border-border",children:[e.jsx(c,{className:"bg-muted/50 border-b pb-3",children:e.jsx(x,{className:"text-base font-bold text-foreground",children:"Resultado del Arqueo"})}),e.jsxs(m,{className:"pt-4 space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-muted-foreground",children:"Usuario Responsable:"}),e.jsx("span",{className:"font-medium",children:s.user.name})]}),e.jsxs("div",{className:"p-4 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-900 rounded-lg text-center",children:[e.jsx("p",{className:"text-sm text-yellow-800 dark:text-yellow-300 uppercase tracking-wide font-semibold",children:"Dinero Contado"}),e.jsxs("p",{className:"text-3xl font-bold text-yellow-900 dark:text-yellow-200",children:["$"," ",Number(s.counted_cash).toFixed(2)]})]}),e.jsx("div",{className:`p-3 rounded text-center border font-bold ${Number(s.difference)===0?"bg-green-100 dark:bg-green-950/30 text-green-700 dark:text-green-300 border-green-200 dark:border-green-900":Number(s.difference)>0?"bg-blue-100 dark:bg-blue-950/30 text-blue-700 dark:text-blue-300 border-blue-200 dark:border-blue-900":"bg-red-100 dark:bg-red-950/30 text-red-700 dark:text-red-300 border-red-200 dark:border-red-900"}`,children:Number(s.difference)===0?"Balance Perfecto":Number(s.difference)>0?`Sobrante: $ ${Number(s.difference).toFixed(2)}`:`Faltante: $ ${Math.abs(Number(s.difference)).toFixed(2)}`}),s.notes&&e.jsxs("div",{className:"text-sm text-muted-foreground bg-muted p-3 rounded italic",children:['" ',s.notes,' "']})]})]})]}),e.jsxs(i,{children:[e.jsx(c,{children:e.jsx(x,{className:"text-lg",children:"Detalle de Movimientos Manuales"})}),e.jsx(m,{children:e.jsxs(_,{children:[e.jsx(v,{children:e.jsxs(u,{children:[e.jsx(r,{children:"Hora"}),e.jsx(r,{children:"Tipo"}),e.jsx(r,{children:"Descripción"}),e.jsx(r,{children:"Usuario"}),e.jsx(r,{className:"text-right",children:"Monto"})]})}),e.jsx(D,{children:d.length===0?e.jsx(u,{children:e.jsx(t,{colSpan:5,className:"text-center py-8 text-gray-400",children:"No hubo movimientos manuales ese día"})}):d.map(a=>e.jsxs(u,{children:[e.jsx(t,{children:new Date(a.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),e.jsx(t,{children:e.jsx(R,{variant:a.type==="ingreso"?"default":"destructive",className:a.type==="ingreso"?"bg-emerald-100 text-emerald-800 hover:bg-emerald-100":"bg-rose-100 text-rose-800 hover:bg-rose-100",children:a.type.toUpperCase()})}),e.jsx(t,{children:a.description}),e.jsx(t,{children:a.user.name}),e.jsxs(t,{className:`text-right font-bold ${a.type==="ingreso"?"text-emerald-600":"text-rose-600"}`,children:[a.type==="ingreso"?"+":"-"," ","$"," ",Number(a.amount).toFixed(2)]})]},a.id))})]})})]})]})})]}),e.jsx(E,{open:f,onOpenChange:n,children:e.jsxs(F,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(P,{children:e.jsx(H,{children:"Vista Previa del Reporte"})}),e.jsx("div",{className:"bg-muted p-4 rounded-md flex justify-center",children:e.jsx(A,{ref:o,data:j})}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx(l,{variant:"outline",onClick:()=>n(!1),children:"Cerrar"}),e.jsxs(l,{onClick:w,children:[e.jsx(p,{className:"w-4 h-4 mr-2"})," Imprimir"]})]})]})})]})}export{ae as default};
