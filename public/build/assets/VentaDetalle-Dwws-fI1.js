import{i as $,r as f,j as e,H as R}from"./app-Bi53cwRe.js";import{M as _,P as u,a as j}from"./MainLayout-jKifpoFS.js";import{H as D}from"./Header-uQBK6Lvz.js";import{B as i}from"./use-theme-CGehCXYH.js";import{C as o,a as d,b as n,c}from"./card-CuJFQQ2i.js";import{T as H,a as U,b as p,c as l,d as V,e as a}from"./table-Cy4khzhc.js";import{D as E,a as I,b as M,c as S}from"./dialog-DHyflgsl.js";import{T as B}from"./Ticket-B8XTleSG.js";import{l as A}from"./index-3JJJLzBS.js";import{A as L}from"./arrow-left-DZzMb7wR.js";import{R as O}from"./receipt-B5-Nrzsd.js";import{C as G}from"./calendar-v_NNEfB-.js";import{U as b}from"./user-DFNe86Sn.js";import{D as z}from"./dollar-sign-CsZ9eZSj.js";import{T as q}from"./trending-up-CPK6GIRv.js";/* empty css            */import"./index-PFpZpo28.js";function ce({venta:s}){const{businessSettings:g,printerSettings:N}=$().props,[w,m]=f.useState(!1),x=f.useRef(null),y={folio:s.folio,fecha:s.fecha,cliente:s.cliente?.nombre||"Público General",cajero:s.usuario,items:s.detalles.map(t=>({descripcion:t.producto,cantidad:t.cantidad,precio:t.precio_unitario,total:t.total})),subtotal:s.subtotal,total:s.total,pago:s.monto_pagado,cambio:s.cambio,metodo_pago:s.metodo_pago},T=()=>{window.history.back()},C=A.useReactToPrint({contentRef:x,documentTitle:`Ticket-${s.folio}`,onAfterPrint:()=>console.log("Impresión finalizada"),onPrintError:t=>console.error("Error al imprimir:",t)}),k=()=>{m(!0)},v=()=>{if(!x.current){console.error("El contenido del ticket no está disponible");return}C()},P=t=>({efectivo:"bg-green-100 text-green-700 border-green-300",tarjeta:"bg-blue-100 text-blue-700 border-blue-300",transferencia:"bg-purple-100 text-purple-700 border-purple-300"})[t]||"bg-gray-100 text-gray-700 border-gray-300",F=t=>({efectivo:"Efectivo",tarjeta:"Tarjeta",transferencia:"Transferencia"})[t]||t,h=s.detalles.reduce((t,r)=>t+Number(r.utilidad),0);return e.jsxs(_,{children:[e.jsx(R,{title:`Venta - ${s.folio}`}),e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsx(D,{title:"Ventas",subtitle:"Información de la venta"}),e.jsx("main",{className:"flex-1 p-6 bg-background",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(i,{variant:"outline",onClick:T,className:"flex items-center gap-3 transition-all duration-200 hover:scale-105",children:[e.jsx(L,{className:"w-6 h-6"}),"Volver"]}),e.jsxs(i,{variant:"outline",onClick:k,className:"flex items-center gap-3 transition-all duration-200 hover:scale-105",children:[e.jsx(u,{className:"w-6 h-6"}),"Imprimir Ticket"]})]}),e.jsxs(o,{className:"border-2 hover:shadow-lg transition-all duration-200",children:[e.jsx(d,{className:"bg-gradient-to-r from-blue-50 to-green-50 dark:from-blue-950 dark:to-green-950",children:e.jsxs(n,{className:"text-2xl flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(O,{className:"w-8 h-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground font-normal",children:"Folio de Venta"}),e.jsx("p",{className:"font-mono",children:s.folio})]})]}),e.jsx("div",{className:`px-4 py-2 rounded-full text-sm font-medium border-2 ${P(s.metodo_pago)}`,children:F(s.metodo_pago)})]})}),e.jsx(c,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(G,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Fecha"}),e.jsx("p",{className:"font-semibold text-sm",children:s.fecha})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center",children:e.jsx(b,{className:"w-6 h-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Cliente"}),e.jsx("p",{className:"font-semibold text-sm",children:s.cliente?.nombre||"Público General"}),s.cliente?.telefono&&e.jsx("p",{className:"text-xs text-muted-foreground",children:s.cliente.telefono})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-full flex items-center justify-center",children:e.jsx(b,{className:"w-6 h-6 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Vendedor"}),e.jsx("p",{className:"font-semibold",children:s.usuario})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(j,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Productos"}),e.jsx("p",{className:"font-semibold text-xl",children:s.detalles.length})]})]})]})})]}),e.jsxs(o,{className:"border-2 hover:shadow-lg transition-all duration-200",children:[e.jsx(d,{children:e.jsxs(n,{className:"flex items-center gap-2",children:[e.jsx(j,{className:"w-5 h-5"}),"Productos Vendidos"]})}),e.jsx(c,{children:e.jsx("div",{className:"rounded-lg border border-border overflow-hidden",children:e.jsxs(H,{children:[e.jsx(U,{children:e.jsxs(p,{className:"bg-muted/50",children:[e.jsx(l,{className:"font-bold",children:"Producto"}),e.jsx(l,{className:"font-bold",children:"Código"}),e.jsx(l,{className:"font-bold text-center",children:"Cantidad"}),e.jsx(l,{className:"font-bold text-right",children:"Precio Unit."}),e.jsx(l,{className:"font-bold text-right",children:"Subtotal"}),e.jsx(l,{className:"font-bold text-right",children:"Utilidad"})]})}),e.jsx(V,{children:s.detalles.map((t,r)=>e.jsxs(p,{className:"hover:bg-muted/50",children:[e.jsx(a,{className:"font-medium",children:t.producto}),e.jsx(a,{className:"font-mono text-sm text-muted-foreground",children:t.codigo||"S/C"}),e.jsx(a,{className:"text-center font-semibold",children:t.cantidad}),e.jsxs(a,{className:"text-right",children:["$",Number(t.precio_unitario).toFixed(2)]}),e.jsxs(a,{className:"text-right font-semibold",children:["$",Number(t.total).toFixed(2)]}),e.jsxs(a,{className:"text-right font-semibold text-green-600",children:["$",Number(t.utilidad).toFixed(2)]})]},r))})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(o,{className:"border-2 hover:shadow-lg transition-all duration-200",children:[e.jsx(d,{children:e.jsxs(n,{className:"flex items-center gap-2",children:[e.jsx(z,{className:"w-5 h-5"}),"Resumen de Pago"]})}),e.jsxs(c,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-lg",children:[e.jsx("span",{className:"text-muted-foreground",children:"Subtotal:"}),e.jsxs("span",{className:"font-semibold",children:["$",Number(s.subtotal).toFixed(2)]})]}),s.impuestos>0&&e.jsxs("div",{className:"flex justify-between text-lg",children:[e.jsx("span",{className:"text-muted-foreground",children:"Impuestos:"}),e.jsxs("span",{className:"font-semibold",children:["$",Number(s.impuestos).toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-2xl font-bold pt-3 border-t-2 border-border",children:[e.jsx("span",{children:"Total:"}),e.jsxs("span",{className:"text-green-600",children:["$",Number(s.total).toFixed(2)]})]}),s.metodo_pago==="efectivo"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between text-lg pt-3 border-t border-border",children:[e.jsx("span",{className:"text-muted-foreground",children:"Monto Recibido:"}),e.jsxs("span",{className:"font-semibold",children:["$",Number(s.monto_pagado).toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-lg",children:[e.jsx("span",{className:"text-muted-foreground",children:"Cambio:"}),e.jsxs("span",{className:"font-semibold text-blue-600",children:["$",Number(s.cambio).toFixed(2)]})]})]})]})]}),e.jsxs(o,{className:"border-2 hover:shadow-lg transition-all duration-200",children:[e.jsx(d,{children:e.jsxs(n,{className:"flex items-center gap-2",children:[e.jsx(q,{className:"w-5 h-5"}),"Análisis de Utilidad"]})}),e.jsxs(c,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-lg",children:[e.jsx("span",{className:"text-muted-foreground",children:"Total Vendido:"}),e.jsxs("span",{className:"font-semibold",children:["$",Number(s.total).toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-lg",children:[e.jsx("span",{className:"text-muted-foreground",children:"Costo Total:"}),e.jsxs("span",{className:"font-semibold text-red-600",children:["$",s.detalles.reduce((t,r)=>t+Number(r.costo)*r.cantidad,0).toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-2xl font-bold pt-3 border-t-2 border-border",children:[e.jsx("span",{children:"Utilidad:"}),e.jsxs("span",{className:"text-green-600",children:["$",h.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-sm text-muted-foreground pt-2",children:[e.jsx("span",{children:"Margen:"}),e.jsxs("span",{className:"font-semibold",children:[(h/Number(s.total)*100).toFixed(1),"%"]})]})]})]})]})]})})]}),e.jsx(E,{open:w,onOpenChange:m,children:e.jsxs(I,{className:"max-w-sm",children:[e.jsx(M,{children:e.jsx(S,{children:"Imprimir Ticket"})}),e.jsx("div",{className:"bg-gray-100 p-4 rounded-md flex justify-center max-h-[60vh] overflow-y-auto",children:e.jsx(B,{ref:x,data:y,businessSettings:g,printerSettings:N})}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx(i,{variant:"outline",onClick:()=>m(!1),children:"Cerrar"}),e.jsxs(i,{onClick:v,children:[e.jsx(u,{className:"w-4 h-4 mr-2"})," Imprimir"]})]})]})})]})}export{ce as default};
